<?xml version="1.0" encoding="utf-8"?>
<modification>
    <code><![CDATA[isense_nitro_pagecache_200]]></code>
    <name><![CDATA[NitroPack Page Cache]]></name>
    <version><![CDATA[2.1.1]]></version>
    <author><![CDATA[iSenseLabs]]></author>
    <link><![CDATA[http://isenselabs.com]]></link>

    <file path="system/engine/action.php">
        <operation>
            <search limit="1"><![CDATA[final class Action {]]></search>
            <add position="before"><![CDATA[
                if (!function_exists('generateNameOfCacheFile')) {
                    require_once DIR_SYSTEM . 'nitro/core/core.php';
                    require_once NITRO_INCLUDE_FOLDER . 'pagecache_top.php';
                }
            ]]></add>
        </operation>
    </file>

    <file path="system/library/response.php">
        <operation>
            <search limit="1"><![CDATA[$this->level = $level;]]></search>
            <add position="after"><![CDATA[
                if (isNitroEnabled() && getNitroPersistence('PageCache.Enabled')) { $this->level = 0; }
            ]]></add>
        </operation>
        
        <operation>
            <search limit="1"><![CDATA[echo $output;]]></search>
            <add position="after"><![CDATA[
                require_once DIR_SYSTEM . 'nitro/core/core.php';
                require_once NITRO_INCLUDE_FOLDER . 'pagecache_bottom.php';
            ]]></add>
        </operation>
    </file>

    <file path="catalog/controller/common/language.php">
        <operation>
            <search limit="1"><![CDATA[$this->session->data['language'] = $this->request->post['code'];]]></search>
            <add position="after"><![CDATA[
                $this->session->data['NitroSwitchLanguage'] = true;
            ]]></add>
        </operation>
    </file>
</modification>
